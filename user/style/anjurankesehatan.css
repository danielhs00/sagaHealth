        :root { --primary: #0b3d91; --bg-light: #f6fbfa; }
        body { font-family: 'Poppins', sans-serif; background: var(--bg-light); margin: 0; color: #333; -webkit-print-color-adjust: exact; }
        
        /* Layout Web */
        .container { max-width: 900px; margin: 40px auto; padding: 0 20px; }
        header { background: #fff; padding: 15px 5%; box-shadow: 0 2px 5px rgba(0,0,0,0.05); display: flex; align-items: center; justify-content: space-between; position: sticky; top: 0; z-index: 99; }
        header img { height: 40px; }
        .btn-home { text-decoration: none; color: var(--primary); font-weight: 600; padding: 8px 15px; border-radius: 6px; transition: 0.3s; }
        .btn-home:hover { background: #eef2ff; }

        /* AI Section */
        .ai-section {
            background: #fff; border-radius: 16px; padding: 30px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); margin-bottom: 30px;
            border-top: 6px solid <?php echo $theme['bar']; ?>;
            page-break-inside: avoid; /* Mencegah terpotong saat print */
        }
        .ai-header { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 15px; }
        .ai-badge { background: #eef2ff; color: #4338ca; padding: 5px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: 700; }
        
        #ai-content { display: none; font-size: 1.05rem; line-height: 1.7; color: #374151; white-space: pre-wrap; text-align: justify; }
        #ai-loading { color: #666; font-style: italic; display: flex; align-items: center; gap: 10px; }
        #ai-error { display: none; color: #991b1b; background: #fee2e2; padding: 15px; border-radius: 8px; }

        /* Stats Grid */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; }
        .stat-card { 
            background: #fff; padding: 20px; border-radius: 12px; border: 1px solid #eee; 
            display: flex; flex-direction: column; justify-content: space-between;
            page-break-inside: avoid;
        }
        .risk-tag { padding: 4px 10px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; width: fit-content; margin-top: 5px; }
        .prog-bg { height: 6px; background: #eee; border-radius: 3px; margin-top: 15px; overflow: hidden; }
        .prog-fill { height: 100%; border-radius: 3px; }

        .btn-print { background: var(--primary); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 1rem; margin-top: 30px; display: inline-flex; align-items: center; gap: 8px; transition: 0.3s; }
        .btn-print:hover { opacity: 0.9; transform: translateY(-1px); }

        /* =========================================
           CSS KHUSUS MODE CETAK (PRINT / PDF) 
           ========================================= */
        @media print {
            body { background: #fff; margin: 0; padding: 0; font-size: 12pt; }
            .container { max-width: 100%; margin: 0; padding: 20px; box-shadow: none; }
            
            /* Sembunyikan Elemen yang Tidak Perlu */
            header, .btn-print, .btn-home, #ai-loading { display: none !important; }

            /* Header Khusus Laporan Cetak */
            .print-header {
                display: block !important;
                text-align: center;
                border-bottom: 2px solid #000;
                padding-bottom: 10px;
                margin-bottom: 30px;
            }
            .print-header img { height: 50px; }
            .print-header h1 { font-size: 18pt; margin: 5px 0 0 0; color: #000; }
            .print-header p { margin: 0; font-size: 10pt; color: #666; }

            /* Atur Ulang Tampilan Card */
            .ai-section, .stat-card {
                box-shadow: none;
                border: 1px solid #ccc;
                /* Memaksa browser mencetak warna background */
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact; 
                background-color: #fff !important; /* Reset bg */
            }

            /* Paksa warna background tag risiko muncul */
            .risk-tag { 
                -webkit-print-color-adjust: exact; 
                print-color-adjust: exact;
                border: 1px solid #000; /* Fallback jika warna hilang */
            }

            /* Atur layout grid agar rapi di kertas A4 */
            .stats-grid {
                grid-template-columns: 1fr 1fr; /* Paksa 2 kolom */
                gap: 10px;
            }

            /* Footer Laporan */
            .print-footer {
                display: block !important;
                margin-top: 50px;
                text-align: right;
                font-size: 10pt;
                color: #555;
            }
        }

        /* Helper Classes untuk Print */
        .print-header, .print-footer { display: none; }